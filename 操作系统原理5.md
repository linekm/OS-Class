### 操作系统原理5

####系统Bios (Basic I/O System )(Fireware，固件) 
基本输入/输出系统
位置:F0000-FFFFF
**类型:**
- Award BIOS 
- AMI BIOS 
- Phoenix BIOS

**功能:** 
- CMOS设置（实模式）
- 基本I/O设备中断服务 
- POST(上电自检) 
- 系统自举（保护模式）

#####POST
**概念：**
Power On Slef-Test(加电自检) 
初始化基本硬件
CPU，内存，显卡... 
自检正常不提示，错误则通过喇叭提示。

**按下PowerOn或者Reset键**
*开始执行**FFFF0**处的指令*

**POST执行完毕后**
1. 查找显卡BIOS，调用显卡BIOS;
2. 依次查找其它设备执行相应设备的BIOS;
3. 显示启动画面
    - BIOS信息 
    - 主板信息 
    - 芯片组型号

#####系统自举
从加电到用户工作环境准备好的过程
 - (1)初始引导 
 - (2)核心初始化 
 - (3)系统初始化

######初始引导

**目的**
把OS核心装入内存并使之开始工作接管计算机系统

**过程**
加电，JUMP POST
BIOS中的启动程序运行

**启动程序**
读取0面0道第1扇区内容(***MBR***)
加载 ***MBR*** 中的 *引导程序*
读取到内存 *07C00* 位置，CPU执行引导程序

**运行引导程序:**
- 根据相关参数，读取硬盘指定位置的文件到内存
- 加载硬盘上OS内核，并初始化基本参数

*常见引导程序：*
(1) ntldr (WinXP以下)
(2) bootmgr(Vista以上含Win7)
(3) GRUB
(4) LILO

**OS内核:**
逐步加载OS剩余部分，最后完全控制计算机

######核心初始化
**目的:** 
OS内核初始化系统的核心数据 
**典型工作**
- 各种寄存器的初始化 
- 存储系统和页表初始化
- 核心进程构建 
- ......

######系统初始化
**目的**
为用户使用系统作准备，使系统处于待命状态。 
**主要工作**
- 初始化文件系统 
- 初始化网络系统 
- 初始化控制台 
- 初始化图形界面 
- ......


####MBR（Main Boot Record）
![屏幕快照 2019-03-06 11.29.39.png-230.1kB][3]


**工作原理**
 - (1)POST → CMOS设置(硬盘启动) → 读取MBR → 控制权交给MBR。
 - (2)MBR读取分区表(Partition Table)，找到其中的 活动分区(Active Partition)，并确认其他的分区都不是活动分区。MBR读取活动分区的第一个分区(次引导记录PBR)，并把它加载到内存中去。
 - (3)PBR控制后面的引导过程。

[3]: http://static.zybuluo.com/linekm/9o5lyyiuhbwaqopg2cpf4g1l/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202019-03-06%2011.29.39.png

 